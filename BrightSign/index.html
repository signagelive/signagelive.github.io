<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>BrightSign Config Generator</title>
		<link href="https://fonts.googleapis.com/css?family=Arimo" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="css/style.css">
		<script src="js/timezones.js"></script>
<style>
</style>
    </head>
    <body>
		 <h1>BrightSign Config Generator</h1>
			<form>
			   <fieldset>
				  <legend>Configuration</legend>
				  <p>
					 <label>Timezone:</label>
					 <select id = "timezoneList">
					 </select>
				  </p>
				  <p>
					 <label>Audio Enabled:</label>
					<input type="checkbox" id="audioEnabled" checked><br/>  
				  </p>
				  <p>
					 <label>Resolution:</label>
					 <select id="videomode">
					<option value="auto">Automatic (screen will detect)</option>
					<option value="640x480x60p">640x480x60p</option>
					<option value="720x480x60i">720x480x60i</option>
					<option value="720x576x50i">720x576x50i</option>
					<option value="848x480x60p">848x480x60p</option>
					<option value="800x600x60p">800x600x60p</option>
					<option value="800x600x75p">800x600x75p</option>
					<option value="960x960x60p">960x960x60p</option>
					<option value="1024x768x60p">1024x768x60p</option>
					<option value="1024x768x75p">1024x768x75p</option>
					<option value="1280x768x60p">1280x768x60p</option>
					<option value="1280x800x60p">1280x800x60p</option>
					<option value="1280x800x75p">1280x800x75p</option>
					<option value="1360x768x60p">1360x768x60p</option>
					<option value="800x1280x60p">800x1280x60p</option>
					<option value="1200x1920x60p">1200x1920x60p</option>
					<option value="1366x768x60p">1366x768x60p</option>
					<option value="1280x960x60p">1280x960x60p</option>
					<option value="1280x1024x60p">1280x1024x60p</option>
					<option value="1280x1024x75p">1280x1024x75p</option>
					<option value="1440x900x60p">1440x900x60p</option>
					<option value="1440x900x75p">1440x900x75p</option>
					<option value="1400x1050x60p">1400x1050x60p</option>
					<option value="1400x1050x75p">1400x1050x75p</option>
					<option value="1600x900x60p">1600x900x60p</option>
					<option value="1600x1200x60p">1600x1200x60p</option>
					<option value="1680x1050x60p">1680x1050x60p</option>
					<option value="1920x540x60p">1920x540x60p</option>
					<option value="1920x1200x60p">1920x1200x60p</option>
					<option value="2048x1152x60p">2048x1152x60p</option>
					<option value="2560x1080x60p">2560x1080x60p</option>
					<option value="2560x1440x30p">2560x1440x30p</option>
					<option value="2560x1440x60p">2560x1440x60p</option>
					<option value="2560x1600x60p">2560x1600x60p</option>
					<option value="3440x1440x30p">3440x1440x30p</option>
					<option value="3440x1440x50p">3440x1440x50p</option>
					<option value="3440x1440x60p">3440x1440x60p</option>
					<option value="720x576x50p">720x576x50p</option>
					<option value="720x480x59.94p">720x480x59.94p</option>
					<option value="720x480x60p">720x480x60p</option>
					<option value="1280x720x24p">1280x720x24p</option>
					<option value="1280x720x23.976p">1280x720x23.976p</option>
					<option value="1280x720x25p">1280x720x25p</option>
					<option value="1280x720x50p">1280x720x50p</option>
					<option value="1280x720x59.94p">1280x720x59.94p</option>
					<option value="1280x720x60p">1280x720x60p</option>
					<option value="1920x1080x50i">1920x1080x50i</option>
					<option value="1920x1080x59.94i">1920x1080x59.94i</option>
					<option value="1920x1080x60i">1920x1080x60i</option>
					<option value="1920x1080x24p">1920x1080x24p</option>
					<option value="1920x1080x23.976p">1920x1080x23.976p</option>
					<option value="1920x1080x25p">1920x1080x25p</option>
					<option value="1920x1080x29.97p">1920x1080x29.97p</option>
					<option value="1920x1080x30p">1920x1080x30p</option>
					<option value="1920x1080x50p">1920x1080x50p</option>
					<option value="1920x1080x59.94p">1920x1080x59.94p</option>
					<option value="1920x1080x60p">1920x1080x60p</option>
					<option value="3840x600x60p">3840x600x60p</option>
					<option value="3840x1080x25p">3840x1080x25p</option>
					<option value="3840x1080x30p">3840x1080x30p</option>
					<option value="3840x2160x23.976p">3840x2160x23.976p</option>
					<option value="3840x2160x24p">3840x2160x24p</option>
					<option value="3840x2160x25p">3840x2160x25p</option>
					<option value="3840x2160x29.97p">3840x2160x29.97p</option>
					<option value="3840x2160x30p">3840x2160x30p</option>
					<option value="3840x1080x50p">3840x1080x50p</option>
					<option value="3840x1080x60p">3840x1080x60p</option>
					<option value="3840x2160x50p">3840x2160x50p</option>
					<option value="3840x2160x59.94p">3840x2160x59.94p</option>
					<option value="3840x2160x60p">3840x2160x60p</option>
					<option value="4096x2160x23.976p">4096x2160x23.976p</option>
					<option value="4096x2160x24p">4096x2160x24p</option>
					<option value="4096x2160x25p">4096x2160x25p</option>
					<option value="4096x2160x29.97p">4096x2160x29.97p</option>
					<option value="4096x2160x30p">4096x2160x30p</option>
					<option value="4096x2160x50p">4096x2160x50p</option>
					<option value="4096x2160x59.94p">4096x2160x59.94p</option>
					<option value="4096x2160x60p">4096x2160x60p</option>

            </select>

					<br/>  
				  </p>
				  <p>
					 <label>Color Space:</label>
					 <select id="colorspace" disabled>
					<option value="rgb">RGB</option>
					<option value="420">YUV 420</option>
					<option value="422">YUV 422</option>
					</select>

					<br/>  
				  </p>
				  <p>
					 <label>Bit Depth:</label>
					 <select id="bitdepth" disabled>
					<option value="8">8</option>
					<option value="10">10</option>
					<option value="12">12</option>
					</select>

					<br/>  
				  </p>
				   <p>
					 <label>Video Transparency (XT3/XT4 Series only):</label>
					<input type="checkbox" id="transparencyEnabled"><br/>  
				  </p>
				  <p>
					<input id="generate" type="button" value="Generate">
				  </p>
			   </fieldset>
			   </form>
			   <form id="networkForm">
			    <fieldset style="margin-top:35px;">
				  <legend>Networking</legend>
				  <p>
					 <label>Networking Mode:</label>
					 <select id = "mode">
						<option value="0">DHCP</option>
						<option value="1">Static IP</option>
					 </select>
				  </p>
				  <p>
					 <label>IP Address:</label>
				     <input type="text" id="ipAddress" placeholder='192.168.0.2' value="" disabled><br/>  
				  </p>
				  <p>
					 <label>Subnet Mask:</label>
				     <input type="text" id="subnet" placeholder='255.255.255.0' value="" disabled><br/>  
				  </p>
				  <p>
					 <label>Default Gateway:</label>
				     <input type="text" id="gateway" placeholder='192.168.0.1' value="" disabled><br/>  
				  </p>
				  <p>
					 <label>DNS1:</label>
				     <input type="text" id="dns1" value="8.8.8.8" disabled><br/>  
				  </p>
				  <p>
					 <label>DNS2:</label>
				     <input type="text" id="dns2" value="8.8.4.4" disabled><br/>  
				  </p>
				  <p>
					 <label>Connection Type:</label>
					 <select id = "connection">
						<option value="0">Ethernet</option>
						<option value="1">Wifi</option>
					 </select>
				  </p>
				  <p>
					 <label>SSID:</label>
				     <input type="text" id="ssid" value="" disabled><br/>  
				  </p>
				  <p>
					 <label>Passphrase:</label>
				     <input type="text" id="passphrase" value="" disabled><br/>  
				  </p>
				   <p>
					 <label>Proxy Server:</label>
				     <input type="text" id="proxy" value="" style="Width: 210px"><br/>  
				  </p>
				  <p>
					 <label>Time Server:</label>
				     <input type="text" id="timeserver" value="ntp://time.brightsignnetwork.com" style="Width: 210px"><br/>  
				  </p>
				  <p>
					<input id="generateNetworkConfig" type="button" value="Generate">
				  </p>			 
			   </fieldset>
			</form>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/jquery.validate.js"></script>
<script>
$(document).ready(function() {
	var option = '';
	for (var i=0;i<timezones.length;i++){
	   option += '<option value="'+ timezones[i].bsid + '">' + timezones[i].displayName  + '</option>';
	}
	$('#timezoneList').append(option);
	$('#timezoneList > option').eq(32).attr('selected','selected');
	

});

$("#mode").change(function(){

  var selectedItem = $('#mode')[0].selectedIndex;

  if(selectedItem == 0)
  {
	$('#ipAddress').prop('disabled', true);
	$('#subnet').prop('disabled', true);
	$('#gateway').prop('disabled', true);
	$('#dns1').prop('disabled', true);
	$('#dns2').prop('disabled', true);
  } else {
  	$('#ipAddress').prop('disabled', false);
	$('#subnet').prop('disabled', false);
	$('#gateway').prop('disabled', false);
	$('#dns1').prop('disabled', false);
	$('#dns2').prop('disabled', false);
  }

});

$("#connection").change(function(){

  var selectedItem = $('#connection')[0].selectedIndex;

  if(selectedItem == 0)
  {
	$('#ssid').prop('disabled', true);
	$('#passphrase').prop('disabled', true);
  } else {
  	$('#ssid').prop('disabled', false);
	$('#passphrase').prop('disabled', false);
  }
});

$("#videomode").change(function(){

  var selectedItem = $('#videomode')[0].selectedIndex;

  if(selectedItem == 0)
  {
	$('#colorspace').prop('disabled', true);
	$('#bitdepth').prop('disabled', true);
  } else {
	$('#colorspace').prop('disabled', false);
	$('#bitdepth').prop('disabled', false);
  }
});

$( "#generateNetworkConfig" ).click(function() {

	var selectedTz = $('#timezoneList')[0].selectedIndex;
	 
	var settings = new Object();  
	settings.networkConfigured = true;
	settings.use_dhcp = true;
	settings.ipv4_address = null;
	settings.subnet_mask = null;
	settings.default_gateway = null;
	settings.dns1 = null;
	settings.dns2 = null;
	settings.use_wifi = false;
	settings.proxy_server = null;
	settings.wifi_network_name = null;
	settings.wifi_pass_phrase = null;
	settings.wifi_security_type = null;
	settings.proxy_server = null;
	settings.time_server = null;
  
    var selectedItem = $('#mode')[0].selectedIndex;

    if(selectedItem == 1)
    { 
		settings.use_dhcp = false;
		settings.ipv4_address = $('#ipAddress').val();
		settings.subnet_mask = $('#subnet').val();
		settings.default_gateway = $('#gateway').val();
		settings.dns1 = $('#dns1').val();
		settings.dns2 = $('#dns2').val();
	}
	
	selectedItem = $('#connection')[0].selectedIndex;
	if(selectedItem == 1)
    { 
		settings.use_wifi = true;
		settings.wifi_network_name = $('#ssid').val();
		settings.wifi_pass_phrase = $('#passphrase').val();
	}
	
	var proxy = $('#proxy').val();
	
	if(proxy && proxy != "")
	{
		settings.proxy_server = proxy;
	}
	
	var timeserver = $('#timeserver').val();
	
	if(timeserver && timeserver != "")
	{
		settings.time_server = timeserver;
	} else 
	{
		settings.time_server = "ntp://time.brightsignnetwork.com";
	}
	
    download('network.json', JSON.stringify(settings));
  
});

$( "#generate" ).click(function() {
  var selectedTz = $('#timezoneList')[0].selectedIndex;
  
  var settings = new Object();  
  settings.isMuted = !$('#audioEnabled').is(":checked");
  settings.showTrace = false;
  settings.rotation = new Object();
  settings.rotation.displayName = "No rotation";
  settings.rotation.angle = 0;
  settings.rotation.id = 0;
  
  settings.timeZone = new Object();
  settings.timeZone.displayName = timezones[selectedTz].displayName;
  settings.timeZone.bsid  = timezones[selectedTz].bsid ;
  settings.timeZone.id = timezones[selectedTz].id;
  settings.modules = new Object();
  settings.remoteFirmwareUpdates = new Object();
  settings.remoteFirmwareUpdates.enabled = false;
  settings.remoteFirmwareUpdates.configured = false;
  
  settings.videoTransparency = new Object();
  settings.videoTransparency.enabled = $('#transparencyEnabled').is(":checked");    
  
  
  settings.videoMode = new Object();
  settings.videoMode.resolution = $('#videomode').val();
  
  if(settings.videoMode.resolution == "auto")
  {
	settings.videoMode.colorSpace = "rgb";
	settings.videoMode.bitDepth = 8;
  } else {
	settings.videoMode.colorSpace = $('#colorspace').val();
	settings.videoMode.bitDepth = parseInt($('#bitdepth').val());
  } 

  download('settings.json', JSON.stringify(settings));
  
});

function download(filename, text) {

    if(window.navigator.msSaveOrOpenBlob) {
		var blob = new Blob([text], {type: 'application/json'});
        window.navigator.msSaveBlob(blob, filename);
    } else {
		var element = document.createElement('a');
		element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
		element.setAttribute('download', filename);
		element.style.display = 'none';
    	document.body.appendChild(element);

		element.click();

		document.body.removeChild(element);
	}

}
</script>
 </body>